---
# .lefthook.yml
min_version: 1.5.0

pre-commit:
  commands:
    # Schnelle Kompilierbarkeits-PrÃ¼fung (WICHTIG: Erste PrÃ¼fung)
    check:
      run: cargo check --all-targets --all-features --quiet --locked --message-format short
      glob: "*.rs"
      fail_text: |
        âŒ Code compilation check failed!
        ğŸ’¡ Fix compilation errors before committing
        ğŸ”§ Run: cargo check --all-targets --all-features

    # Code-Formatierung prÃ¼fen
    format:
      run: cargo fmt -- --check
      glob: "*.rs"
      fail_text: |
        âŒ Code formatting issues found!
        ğŸ’¡ Run: cargo fmt

    # Linting mit Clippy
    clippy:
      run: cargo clippy --all-targets --all-features --quiet --locked --message-format short -- -D warnings
      glob: "*.rs"
      fail_text: |
        âŒ Clippy warnings found!
        ğŸ’¡ Fix all warnings before committing

    # Schnelle Tests (nur Library)
    test-lib:
      run: cargo test --lib --no-fail-fast --quiet --locked --message-format short
      glob: "*.rs"
      fail_text: |
        âŒ Library tests failed!
        ğŸ’¡ Fix failing tests before committing

commit-msg:
  commands:
    cocogitto-verify:
      run: cog verify --file {0}
      fail_text: |
        âŒ Commit message validation failed!
        ğŸ’¡ Use: cog commit (interactive)
        ğŸ’¡ Or: git config commit.template .gitmessage
        ğŸ”— Format: https://www.conventionalcommits.org/

pre-push:
  commands:
    # VollstÃ¤ndige Kompilierung aller Targets
    check-all:
      run: cargo check --all-targets --all-features --release --quiet --locked --message-format short
      fail_text: |
        âŒ Release compilation check failed!
        ğŸ’¡ Fix compilation issues before pushing

    # VollstÃ¤ndige Tests
    test-all:
      run: cargo test --lib --bins --tests --all-features --release --quiet --locked --message-format short
      fail_text: |
        âŒ Full test suite failed!
        ğŸ’¡ All tests must pass before pushing

    # Benchmarks kompilieren
    benchmarks:
      run: cargo check --benches --all-features
      fail_text: |
        âŒ Benchmark compilation failed!
        ğŸ’¡ Ensure benchmarks compile before pushing

    # Strikte Clippy-PrÃ¼fung
    clippy:
      run: cargo clippy --all-targets --all-features --release --quiet --locked --message-format short -- -D warnings
      fail_text: |
        âŒ Clippy checks failed!
        ğŸ’¡ Fix pedantic warnings before pushing

